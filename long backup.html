<!DOCTYPE html>


<!--


Without using pattern="^[0-9]*$" etc.


Add drop down for us/other formats input functionality.


Add feature that senses what format based on first/second chr's, and selects value on drop down.


submit button to display date on page.


Case 5 leftover:-
else if (prevChr == 1 && !isNaN(thirdReversedChr) && !isNaN(integerCheck)) {
	delChr();
} else if (prevChr == 0 && !isNaN(thirdReversedChr) && !isNaN(integerCheck)) {
	delChr();
}


focus loss if too short, delete what's in the space.
-->


<html>
	<head>
		<!-- Set a Responsive scaled viewport, and assign Metadata. -->
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1">
			<title>Project 2: Date Field Validation</title>
		<meta name="author" content="Tom B">
		<meta name="description" content="Date Field Validation, JavaScript">
		
		<style type="text/css">
			button {
				pointer-events: auto;
			}
			input[type=text] {
				width: 25%;
				padding: 5px;
				margin: 20px;
				box-sizing: border-box;
				border: none;
				border-bottom: 3px solid rgb(161, 1, 1);
				color: white;
				background-color: rgb(13, 112, 99);
				
			}
			
			input[type=text]:focus {
				width: 50%;
				color: black;
				border: 3px solid rgb(32, 221, 32);
				background-color: #89f885;
				
			}
			
			input::placeholder {
				color: rgb(161, 1, 1);
			}
			
			#form {
				width: 30%;
				border: 3px solid rgb(19, 0, 128);
				overflow: visible;
				background-color: rgb(13, 112, 99);
				float: left;
				pointer-events: none;
			}

			#output {
				width: 30%;
				border: 3px solid rgb(4, 77, 8);
				background-color: rgb(91, 100, 12);
				float: left;
				margin-left: 3px;
			}
			
		</style>
	</head>
	
	<body>
		<div id="form">
			<button onclick="inputField.focus();">Change Date</button>
			<input name="DateInput" type="text" placeholder="dd/mm/yyyy" onfocus="this.select();">
			<p>Please enter a date in a UK format, anything similar to "dd/mm/yyyy". For example; "29/7/19".</p>
		</div>

		<div id="output">
			<p>Results:-</p>
			</br>
			<p id="d1">D1</p>
			<p id="d1">D2</p>
		</div>
		
		<script type="text/javascript">
			let inputField = document.getElementsByName('DateInput')[0];

			if (document.addEventListener) document.addEventListener("DOMContentLoaded", initialised, false);
			else if (document.attachEvent) document.attachEvent("onreadystatechange", initialised);
			else window.onload = initialised;
			
			function initialised() {
				inputField.addEventListener('keyup', function() {
					checkInputtedChr(inputField);
				});

				inputField.addEventListener('keydown', function(event) {
					if ([36, 37, 38, 40].indexOf(event.keyCode) > -1) {
						event.preventDefault();
					}
				});
			}
			
			function checkInputtedChr(field) {
				let fieldVal = field.value;
				let n = fieldVal.length;
				let character = fieldVal[n-1];
				let prevChr = fieldVal[n-2];
				let thirdReversedChr = fieldVal[n-3];
				let integerCheck = parseInt(character);
				
				switch(n) {
					case 1:
						if (isNaN(integerCheck)) {
							delChr();
						}
						break;

					case 2:
						if (prevChr == 0 && (isNaN(integerCheck) || integerCheck == 0)) {
							delChr();
						} else if (prevChr == 3 && integerCheck > 1) {
							delChr();
						} else if (['/','-','.'].indexOf(character) == -1 && (isNaN(integerCheck) || prevChr > 3)) {
							delChr(1);
						}
						break;

					case 3:
						if (isNaN(prevChr) && isNaN(integerCheck)) {
							delChr();
						} else if (!isNaN(prevChr) && ['/','-','.'].indexOf(character) == -1) {
							delChr(1);
						}
						break;

					case 4:
						if (isNaN(prevChr) && isNaN(integerCheck)) {
							delChr();
						} else if (prevChr == 0 && (isNaN(integerCheck) || integerCheck == 0)) {
							delChr();
						} else if (prevChr == 1 && ['/','-','.'].indexOf(character) == -1 && (integerCheck > 2 || isNaN(integerCheck))) {
							delChr(1);
						} else if (prevChr > 1 && ['/','-','.'].indexOf(character) == -1) {
							delChr(1);
						}
						break;

					case 5:
						if (isNaN(prevChr) && isNaN(integerCheck)) {
							delChr();
						} else if (prevChr < 2 && ['/','-','.'].indexOf(character) == -1 && isNaN(integerCheck)) {
							delChr(1);
						} else if (prevChr > 1 && ['/','-','.'].indexOf(character) == -1) {
							delChr(1);
						} else if (prevChr == 1 && (integerCheck > 2 ||(!isNaN(thirdReversedChr) && !isNaN(integerCheck)))) {
							delChr();
						} else if (prevChr == 0 && ((isNaN(thirdReversedChr) && (isNaN(integerCheck) || integerCheck == 0)) || (!isNaN(thirdReversedChr) && !isNaN(integerCheck)))) {
							delChr();
						}
						break;

					case 6:
						if (isNaN(prevChr) && isNaN(integerCheck)) {
							delChr();
						} else if (!isNaN(prevChr) && ((isNaN(thirdReversedChr) && isNaN(integerCheck)) || (!isNaN(thirdReversedChr) && ['/','-','.'].indexOf(character) == -1))) {
							delChr(1);
						}
						break;

					case 7:
					case 8:
						if (isNaN(integerCheck)) {
							delChr();
						}
						break;

					case 9:
						if (isNaN(integerCheck) || fieldVal.lastIndexOf("/") == 3) {
							delChr();
						}
						break;

					case 10:
						if (isNaN(integerCheck) || fieldVal.lastIndexOf("/") == 4) {
							delChr();
						}
						break;
					default:
						delChr();
				}

				function delChr(a) {
					field.value = fieldVal.substring(0, n-1);
					if (a) {
						//alert('truthy');
						field.value = field.value + '/'
					}
				}
			}
		</script>
	</body>
</html>